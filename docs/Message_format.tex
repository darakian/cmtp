\documentclass[a4paper,11pt]{IEEEtran}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}
\usepackage{graphicx}
\usepackage{float}

\title{The Cipher Mail Message Format}
\author{Jonathan Moroney}

\begin{document}

\maketitle
\tableofcontents

%\begin{abstract}
%This document outlines the format of the messages used in the CMTP protocol.
%\end{abstract}

\section{High level overview}
At the high level a Cipher Mail Message is broken into two classes. Envelope Data and Message Data. Envelope data is the plaintext used for routing a message and determining how to read it. Message data is the encrypted payload. Envelope information includes the sender and receiver, the version number, the log length and log body, the attachment count and attachment lengths, and the message length. All data is in network order on the wire. That is Big Endian.
\begin{figure}[H]
\centering
\includegraphics[width=0.5\linewidth]{message_format.eps}
\caption{Cipher Mail Message Format}
\end{figure}
In figure 1 we see the a graphical overview of the message format. A single row is 8 bytes and a sawtooth bottom means variable length. Abreviations are:
\begin{enumerate}
  \item A.Count = Attachment Count
  \item D.Account = Destination Account
  \item D.Domain = Destination Domain
  \item S.Account = Source Account
  \item S.Domain = Source Domain
\end{enumerate}

Field Defenitions are as follows
\begin{description}
  \item[Version] \hfill \\ A four byte integer used to mark crypto version in use.
  \item[Attachment Count] \hfill \\ A four byte integer used to mark how many attachment fields follow.
  \item[Log Length] \hfill \\ An eight byte integer (long) used to mark how many bytes are in the log field.
  \item[Body Length] \hfill \\  An eight byte integer (long) used to mark how many bytes are in the message body field.
  \item[Destination Account] \hfill \\ A null terminated utf-8 string used to denote the recipient account of the message. Max length is 255 bytes.
  \item[Destination Domain] \hfill \\ A null terminated utf-8 string used to denote the recipient domain of the message. Max length is 255 bytes.
  \item[Source Account] \hfill \\ A null terminated utf-8 string used to denote the sender account of the message. Max length is 255 bytes.
  \item[Source Domain] \hfill \\ A null terminated utf-8 string used to denote the sender domain of the message. Max length is 255 bytes.
  \item[Log] \hfill \\ Discussed in section II.
  \item[Message Body] \hfill \\ Discussed in section III.
  \item[Attachment Length] \hfill \\ An eight byte integer (long) used to mark how many bytes are in next attachment body.
  \item[Attachment Body] \hfill \\ Discussed in section IV.
  
\end{description}


\section{Log Structure}
Text

\section{Message Body Structure}

\section{Attachment Structure}

\end{document}
